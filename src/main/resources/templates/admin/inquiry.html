<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>1:1 문의 관리 | FesLite</title>
  <base href="/">
  <link th:href="@{/css/adminStyle.css}" rel="stylesheet">
  <script defer th:src="@{/js/adminApp.js}"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body{margin:0;font-family:'Pretendard',sans-serif;background:#f5f6fa;display:flex;height:100vh;}
    .sidebar{width:240px;background:#1f1f2e;color:#fff;padding:20px 0;display:flex;flex-direction:column;}
    .sidebar a{display:block;padding:12px 20px;color:#ccc;text-decoration:none;}
    .sidebar a:hover,.active{background:linear-gradient(135deg,#b5fffc 0%,#ffdee9 100%);color:#000;font-weight:600;}
    .main{flex:1;overflow-y:auto;}
    header{background:#fff;box-shadow:0 1px 6px rgba(0,0,0,0.1);padding:15px 30px;display:flex;justify-content:space-between;}
    .content{padding:25px;}
    table{background:#fff;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.08);}
    a.inquiry-link {color:#007bff;text-decoration:none;font-weight:500;cursor:pointer;}
    a.inquiry-link:hover {text-decoration:underline;}
    .sidebar h2{text-align:center;font-size:20px;font-weight:700;margin-bottom:30px;line-height:1.2;white-space:nowrap;}
  </style>
</head>

<body>
  <!-- 좌측 사이드바 -->
  <div th:replace="~{common/adminAside :: aside}"></div>

  <!-- 메인 영역 -->
  <div class="main">
    <header>
      <h4>1:1 문의 관리</h4>
      <button class="btn btn-outline-danger btn-sm">로그아웃</button>
    </header>

    <div class="content">
      <table class="table table-hover align-middle text-center">
        <thead class="table-light">
          <tr>
            <th>회원명</th>
            <th>이메일</th>
            <th>제목</th>
            <th>등록일</th>
            <th>처리상태</th>
            <th>관리</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="inquiry : ${list}">
            <td th:text="${inquiry.member_name}"></td>
            <td th:text="${inquiry.member_email}"></td>

            <!-- ✅ 제목 클릭 시 모달 띄우기 -->
            <td>
              <a class="inquiry-link"
                 th:data-title="${inquiry.inquiry_title}"
                 th:data-content="${inquiry.inquiry_content}"
                 onclick="openInquiryModal(this)">
                <span th:text="${inquiry.inquiry_title}"></span>
              </a>
            </td>

            <td th:text="${inquiry.inquiry_regDate}"></td>
            <td><span class="badge bg-warning text-dark">대기</span></td>
            <td><button class="btn btn-success btn-sm">답변하기</button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ✅ 문의 상세 모달 -->
  <div class="modal fade" id="inquiryDetailModal" tabindex="-1" aria-labelledby="inquiryModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="inquiryModalLabel">문의 상세내용</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
        </div>
        <div class="modal-body">
          <h6 id="modalTitle" class="fw-semibold mb-3"></h6>
          <div id="modalContent" class="border rounded bg-light p-3" style="min-height:120px;"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
          <button class="btn btn-success">답변하기</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ✅ JS -->
  <script>
    function openInquiryModal(el) {
      // 데이터 속성에서 값 읽기
      const title = el.getAttribute("data-title");
      const content = el.getAttribute("data-content");

      // 모달에 값 넣기
      document.getElementById("modalTitle").innerText = title;
      document.getElementById("modalContent").innerText = content;

      // 모달 표시
      const modal = new bootstrap.Modal(document.getElementById("inquiryDetailModal"));
      modal.show();
    }
  </script>
</body>
</html>