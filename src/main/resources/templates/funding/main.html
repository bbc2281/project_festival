<!DOCTYPE html>
<html lang="ko"  xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FesLite — 펀딩 메인</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
<link th:href="@{/css/funding.css}" rel="stylesheet" />
</head>
<body class="funding-bg">
<header class="border-bottom bg-white bg-opacity-75 backdrop-blur sticky-top">
  <div class="container d-flex align-items-center gap-3 py-2">
    <a class="navbar-brand fw-bold" th:href="@{/funding/main}">FesLite Funding</a>
    <a class="text-muted d-none d-md-block" th:href="@{/}">축제 페이지</a>
    <form class="d-none d-md-flex ms-auto w-50" role="search" onsubmit="return false;">
      <div class="input-group">
        <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
        <input id="searchInput" type="search" class="form-control" placeholder="축제, 지역, 테마로 검색" />
      </div>
    </form>
    <div sec:authorize="isAnonymous()">
        <a th:href="@{/auth/loginPage}" class="btn btn-outline-secondary" >로그인</a>
        </div>
    <div sec:authorize="hasAuthority('ROLE_COMPANY')">
      <a class="btn btn-gradient" th:href="@{/funding/register}">펀딩 등록하기</a>
    </div>
  </div>
</header>

<!-- 슬라이드 배너 -->
<section class="top-banner">
  <div id="topBanner" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
    <div class="carousel-inner">
      <!-- Slide 1: 시민과 함께 만드는 펀딩 -->
      <div class="carousel-item active">
        <div class="banner-slide" style="background-image: url('https://images.unsplash.com/photo-1508672019048-805c876b67e2?q=80&w=1600&auto=format&fit=crop');">
          <div class="banner-overlay"></div>
          <div class="banner-content text-white text-center">
            <h3>지금 열릴 축제! 시민과 함께 만드는 펀딩</h3>
            <p>지역상권과 상생하는 안전한 축제를 위해, 지금 후원에 참여해보세요.</p>
          </div>
        </div>
      </div>
      <!-- Slide 2: 불꽃/음악/먹거리 -->
      <div class="carousel-item">
        <div class="banner-slide" style="background-image: url('https://images.unsplash.com/photo-1504384308090-c894fdcc538d?q=80&w=1600&auto=format&fit=crop');">
          <div class="banner-overlay"></div>
          <div class="banner-content text-white text-center">
            <h3>불꽃 · 음악 · 먹거리까지, 테마별로 보기</h3>
            <p>원하는 테마를 골라 빠르게 찾아보세요. (아래 카테고리 탭)</p>
          </div>
        </div>
      </div>
      <!-- Slide 3: 후원자 혜택 -->
      <div class="carousel-item">
        <div class="banner-slide" style="background-image: url('https://images.unsplash.com/photo-1511795409834-ef04bbd61622?q=80&w=1600&auto=format&fit=crop');">
          <div class="banner-overlay"></div>
          <div class="banner-content text-white text-center">
            <h3>후원자 혜택 가득! 굿즈 · 포토존 · 이름 기재</h3>
            <p>작은 후원이 큰 변화를 만듭니다.</p>
          </div>
        </div>
      </div>
    </div>
    <!-- Carousel Controls -->
    <button class="carousel-control-prev" type="button" data-bs-target="#topBanner" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#topBanner" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</section>



<!-- 메인 축제소환 구역 -->

<nav class="border-top border-bottom bg-white bg-opacity-75">
  <div class="container py-2">
    <ul id="categoryTabs" class="nav nav-pills justify-content-center flex-wrap gap-2">
      <li class="nav-item"><button class="nav-link active" data-category="all">전체</button></li>
      <li th:each="cat : ${category}" class="nav-item"><button class="nav-link" th:data-category="${cat.festival_category_name}" th:text="${cat.festival_category_name}"></button></li>
    </ul>
  </div>
</nav>



<main class="py-4">
  <div class="container">
<div id="fundingGrid" class="row g-3 g-md-4">

<div th:each="funding : ${fundingList}" 
     class="col-6 col-md-4 col-lg-3 funding-card" 
     data-category="축제"
     th:data-category="${funding.festival_category_name}"
     th:data-title="${funding.festival_name}" 
     th:data-end="${funding.funding_end_date}" 
     th:data-raised="${funding.festival_amount}" 
     th:data-goal="${funding.festival_total_amount}">
  
  <a class="card h-100 shadow-hover text-decoration-none" 
     th:href="@{/funding/info(id=${funding.funding_festival_idx})}">
    
    <div class="ratio ratio-4x3">
      <img class="rounded-top object-fit-cover" 
           th:src="${funding.festival_img_path != null ? funding.festival_img_path : '/images/default.png'}" 
           alt="축제 포스터"/>
    </div>
    
    <div class="card-body">
      <h6 class="card-title text-truncate" th:text="${funding.festival_name}"></h6>
      <p class="card-text text-muted small mb-2" th:text="${funding.festival_short}"></p>
      
      <!-- 진행률 바 -->
      <div class="progress mb-1">
        <div class="progress-bar" role="progressbar"></div>
      </div>
      
      <!-- % / 금액 -->
      <div class="d-flex justify-content-between small">
        <span>
        <span class="fw-semibold percent-txt">0</span><span>%</span>
        </span>
        <span class="text-muted">
          <span class="raised-txt" th:text="${funding.festival_amount}"></span> / 
          <span class="goal-txt" th:text="${funding.festival_total_amount}"></span>
        </span>
      </div>
      
      <!-- D-day -->
      <div class="mt-1 small text-danger fw-semibold">
        D-<span class="dday-txt">0</span>
      </div>
    </div>
  </a>
</div>
    </div>
  </div>
</main>

<footer class="py-5 text-center text-muted small">
  <div class="container">© 2025 FesLite Funding</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/funding.js}"></script>
<script>
window.addEventListener('DOMContentLoaded',()=>{ if(window.initFundingHome) initFundingHome(); });
</script>
</body>
</html>
