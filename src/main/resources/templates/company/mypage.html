<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
  <title>ê¸°ì—…íšŒì› ë§ˆì´í˜ì´ì§€ â€” FesLite</title>
  <link rel="stylesheet" />
  <script defer th:src="@{/js/app.js}"></script>

  <style>
    /* (CSS ë™ì¼ â€” ìƒëµ ì—†ì´ ê·¸ëŒ€ë¡œ ìœ ì§€) */
    body {
      background: linear-gradient(135deg, #ffdee9 0%, #b5fffc 100%);
      font-family: 'Pretendard', sans-serif;
    }
    .mypage-wrapper {
      display: grid;
      grid-template-columns: 240px 1fr;
      gap: 24px;
      max-width: 1100px;
      margin: 40px auto;
      padding: 0 16px;
    }
    .sidebar {
      background: #ffffffc9;
      border-radius: 14px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.1);
      padding: 20px 16px;
      backdrop-filter: blur(6px);
      align-self: start;
      max-height: 580px;
      overflow-y: auto;
    }
    .menu { display:flex; flex-direction:column; gap:6px; }
    .menu a { display:flex; justify-content:space-between; align-items:center; text-decoration:none; color:#333; padding:10px 12px; border-radius:10px; transition:background .15s ease, color .15s ease; font-weight:600; }
    .menu a:hover { background:#f0f2ff; color:#6b21a8; transform:translateX(1px); }
    .menu a.active { background:#6b21a8; color:#fff; }
    .menu a.text-danger { color:#ef4444; }
    .main { display:flex; flex-direction:column; gap:24px; }
    .profile-card { background:#fff; border-radius:20px; box-shadow:0 4px 14px rgba(0,0,0,0.1); padding:28px 32px; display:flex; flex-direction:column; gap:18px; }
    .profile-top { display:flex; align-items:center; justify-content:space-between; gap:16px; flex-wrap:wrap; }
    .profile-left { display:flex; align-items:center; gap:18px; }
    .profile-left img { width:92px; height:92px; border-radius:50%; object-fit:cover; background:#f3f4f6; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    .profile-info h3 { margin:0; font-size:22px; font-weight:800; }
    .profile-info p { margin:4px 0; color:#555; font-size:14px; }
    .extra-info { margin-top:6px; font-size:13px; color:#666; line-height:1.6; }
    .profile-actions { display:flex; gap:10px; }
    .profile-actions .btn { padding:10px 14px; border-radius:10px; font-size:14px; font-weight:700; }
    .section-title { font-size:18px; font-weight:800; margin:6px 2px; }
    .dashboard { display:grid; gap:16px; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); }
    .dash-card { background:#fff; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.08); padding:22px 24px; transition:transform .15s ease; }
    .dash-card:hover { transform:translateY(-3px); }
    .dash-title { font-size:13px; opacity:.8; margin-bottom:6px; }
    .dash-value { font-size:26px; font-weight:900; }
    .dash-purple{ background:#ede9fe; color:#5b21b6; }
    .dash-orange{ background:#fff4e7; color:#b45309; }
    .dash-blue{ background:#e0f2fe; color:#075985; }
    .dash-green{ background:#dcfce7; color:#065f46; }
    .dash-violet{ background:#f3e8ff; color:#6b21a8; }
    .dash-yellow{ background:#fef9c3; color:#854d0e; }
    .activity-box { background:#ffffffc9; border-radius:16px; padding:20px 24px; box-shadow:0 4px 10px rgba(0,0,0,0.06); }
    .activity-box h4 { font-weight:800; margin-bottom:12px; }
    .activity-box ul { list-style:none; padding:0; margin:0; }
    .activity-box li { padding:10px 0; border-bottom:1px solid #eee; font-size:14px; display:flex; justify-content:space-between; }
    @media (max-width:900px){ .mypage-wrapper{ grid-template-columns:1fr; } }
  </style>
</head>

<body>
  <!-- ìƒë‹¨ ë„¤ë¹„ë°” -->
  <div th:replace="~{common/header :: header}"></div>

  <!-- âœ… CSRF ìˆ¨ê¹€ ìœ ì§€ -->
  <form style="display:none;" th:if="${_csrf}" th:action="@{/noop}">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
  </form>

  <main class="mypage-wrapper">
    <!-- ì¢Œì¸¡ ë©”ë‰´ -->
    <aside class="sidebar">
      <h2>ë§ˆì´í˜ì´ì§€</h2>
      <nav class="menu">
        <a th:href="@{/company/edit}">íšŒì›ì •ë³´ ìˆ˜ì •<span>â€º</span></a>
        <a th:href="@{/company/favorite}">ê´€ì‹¬ ìˆëŠ” ì¶•ì œ<span>â€º</span></a>
        <a th:href="@{/company/festival}">ë‚˜ì˜ ì¶•ì œ ì¡°íšŒ<span>â€º</span></a>
        <a th:href="@{/company/sponsor}">í›„ì› ì¡°íšŒ<span>â€º</span></a>
        <a th:href="@{/company/delete}" class="text-danger">íšŒì›íƒˆí‡´<span>â€º</span></a>
      </nav>
    </aside>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <section class="main">
      <!-- ê¸°ì—… í”„ë¡œí•„ -->
      <section class="profile-card">
        <div class="profile-top">
          <div class="profile-left">
            <img th:src="@{/images/company_icon.png}" alt="ê¸°ì—… ë¡œê³ ">
            <div class="profile-info">
              <h3>[[${displayName}]] ë‹˜</h3>
              <p th:text="${companyInfo.company_email}"></p>
              <div class="extra-info">
                ê¸°ì—…ì´ë¦„: <span th:text="${companyInfo.company_name}"></span><br>
                ì„¤ë¦½ì¼: <span th:text="${companyInfo.company_open_date}"></span>
                íšŒì› ìœ í˜•: <span th:text="${companyInfo.role}"></span><br> 
              </div>
            </div>
          </div>
          <div class="profile-actions">
            <a th:href="@{/company/edit}" class="btn btn-primary">ê¸°ì—…ì •ë³´ ìˆ˜ì •</a>
            <a th:href="@{/company/festival}" class="btn btn-accent">ë“±ë¡ ì¶•ì œ ê´€ë¦¬</a>
          </div>
        </div>
      </section>

      <!-- í˜„í™© -->
      <h3 class="section-title">ê¸°ì—… í™œë™ í˜„í™©</h3>
      <section class="dashboard">
        <div class="dash-card dash-purple">
          <div class="dash-title">ë“±ë¡í•œ ì¶•ì œ</div>
          <div class="dash-value" th:text="${stats.registeredFestivals}">5</div>
        </div>
        <div class="dash-card dash-orange">
          <div class="dash-title">í›„ì›ë°›ì€ ê¸ˆì•¡</div>
          <div class="dash-value" th:text="'â‚©' + ${#numbers.formatInteger(stats.totalSponsored, 3, 'COMMA')}">â‚©1,200,000</div>
        </div>
        <div class="dash-card dash-blue">
          <div class="dash-title">ê´€ì‹¬ ë°›ì€ ìˆ˜</div>
          <div class="dash-value" th:text="${stats.likes}">24</div>
        </div>
        <div class="dash-card dash-green">
          <div class="dash-title">ì´ë²¤íŠ¸ ì£¼ìµœ ìˆ˜</div>
          <div class="dash-value" th:text="${stats.eventsHosted}">3</div>
        </div>
        <div class="dash-card dash-violet">
          <div class="dash-title">ë„¤íŠ¸ì›Œí¬ ì—°ê²° ê¸°ì—…</div>
          <div class="dash-value" th:text="${stats.networks}">7</div>
        </div>
        <div class="dash-card dash-yellow">
          <div class="dash-title">ì‹ ê·œ ì œì•ˆì„œ</div>
          <div class="dash-value" th:text="${stats.newProposals}">2</div>
        </div>
      </section>

      <!-- ìµœê·¼ ë“±ë¡í•œ ì¶•ì œ -->
      <section class="activity-box">
        <h4>ìµœê·¼ ë“±ë¡í•œ ì¶•ì œ</h4>
        <ul>
          <li th:each="f : ${recentFestivals}">
            <span th:text="${f.name}">ğŸª ì„œìš¸ ë¶ˆë¹›ì •ì› í˜ìŠ¤í‹°ë²Œ</span>
            <span th:text="${f.status}">ìŠ¹ì¸ ëŒ€ê¸°</span>
          </li>
        </ul>
      </section>

      <!-- ìµœê·¼ í›„ì› ë‚´ì—­ -->
      <section class="activity-box">
        <h4>ìµœê·¼ í›„ì› ë‚´ì—­</h4>
        <ul>
          <li th:each="s : ${recentSponsors}">
            <span th:text="${s.festivalName}">ì„œìš¸ ë¶ˆë¹›ì •ì›</span>
            <span th:text="'â‚©' + ${#numbers.formatInteger(s.amount, 3, 'COMMA')}">â‚©450,000</span>
          </li>
        </ul>
      </section>
    </section>
  </main>

  <!-- âœ… í‘¸í„° -->
  <footer class="footer">
    <div class="container">Â© 2025 FesLite â€” ëª¨ë‘ì˜ ì¶•ì œë¥¼ ì—°ê²°í•©ë‹ˆë‹¤ ğŸª</div>
  </footer>
</body>
</html>
